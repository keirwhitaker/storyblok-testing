<section class="max-w-5xl mx-auto px-4 py-10">
  <header class="mb-8">
    <h1 class="text-3xl font-extrabold">{{ page.title }}</h1>
    {% if page.description %}
      <p class="mt-2 text-neutral-600">{{ page.description }}</p>
    {% endif %}
  </header>

  {% assign matches = 0 %}

  <ul class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for p in site.places | sort: "title" %}
      {% assign show = false %}

      {% if page.type == "neighbourhood" and p.neighbourhood %}
        {% if p.neighbourhood | downcase == page.title | downcase %}
          {% assign show = true %}
        {% endif %}
      {% elsif page.type == "category" and p.category %}
        {% if p.category | downcase == page.title | downcase %}
          {% assign show = true %}
        {% endif %}
      {% elsif page.type == "fb_type" and p.fb_type %}
        {% if p.fb_type | downcase == page.title | downcase %}
          {% assign show = true %}
        {% endif %}
      {% elsif page.type == "perfect_for" and p.perfect_for %}
        {%- comment -%}
          perfect_for is an array of strings. We'll do a
          case-insensitive contains check by joining + downcasing.
        {%- endcomment -%}
        {% assign pf_joined = p.perfect_for | join: "||" | downcase %}
        {% if pf_joined contains page.title | downcase %}
          {% assign show = true %}
        {% endif %}
      {% endif %}

      {% if show %}
        {% assign matches = matches | plus: 1 %}
        <li class="rounded-xl border shadow-sm overflow-hidden bg-white">
          <a href="{{ p.url }}" class="block">
            {% if p.gallery and p.gallery.first %}
              <img src="{{ p.gallery.first }}" alt="{{ p.title }}" class="w-full h-44 object-cover">
            {% endif %}
            <div class="p-4">
              <h2 class="font-bold text-lg">{{ p.title }}</h2>
              {% if p.short_description %}
                <p class="text-sm text-neutral-700 mt-1">{{ p.short_description }}</p>
              {% endif %}
              <div class="text-xs text-neutral-500 mt-2 space-x-3">
                {% if p.neighbourhood %}<span>{{ p.neighbourhood }}</span>{% endif %}
                {% if p.category %}<span>• {{ p.category }}</span>{% endif %}
                {% if p.fb_type %}<span>• {{ p.fb_type }}</span>{% endif %}
              </div>
            </div>
          </a>
        </li>
      {% endif %}
    {% endfor %}
  </ul>

  {% if matches == 0 %}
    <p class="text-neutral-600">No listings found yet.</p>
  {% endif %}
</section>